function Export-ToExcel($listView, $filePath) {
    # Create a new Excel application object
    $excel = New-Object -ComObject Excel.Application

    # Add a new workbook
    $workbook = $excel.Workbooks.Add()

    # Get the default worksheet
    $worksheet = $workbook.Worksheets.Item(1)

    # Write the ListView column headers to the first row in Excel
    $colIndex = 1
    foreach ($column in $listView.Columns) {
        $worksheet.Cells.Item(1, $colIndex) = $column.Text
        $colIndex++
    }

    # Write the ListView data to Excel
    $rowIndex = 2
    foreach ($item in $listView.Items) {
        $colIndex = 1
        foreach ($subItem in $item.SubItems) {
            $worksheet.Cells.Item($rowIndex, $colIndex) = $subItem.Text
            $colIndex++
        }
        $rowIndex++
    }

    # Save the Excel file
    $workbook.SaveAs($filePath)

    # Close the workbook and Excel application
    $workbook.Close()
    $excel.Quit()

    # Clean up COM objects
    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($worksheet) | Out-Null
    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($workbook) | Out-Null
    [System.Runtime.Interopservices.Marshal]::ReleaseComObject($excel) | Out-Null

    # Display a message box with the export completion message
    [System.Windows.Forms.MessageBox]::Show("Data exported to '$filePath' successfully!", "Export Complete", "Information", [System.Windows.Forms.MessageBoxButtons]::OK)
}
